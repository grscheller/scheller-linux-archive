#!/bin/bash
#
# Distribute linuxHome to all computers where I have work logins
#
# File: ~/bin/pushHome
# Usage: On the system I maintain the source code with git, 
#        pushHome
#
# Note: Passwordless ssh needs to have been configured.
#       Using shell functions defined in ~/.bashrc
#
# Written by Geoffrey Scheller
#

# If not on rygar, punt.
comp=$(hostname)
if [[ ${comp%%.*} != "drxrytl410kzv" ]]
then
    echo "Error: Only use this command on rygar"
    exit 1
fi

shopt -s expand_aliases  # let this script use aliases as if interactive
source ~/.bashrc   # make sure I have my aliases and shell functions

[[ -d ~/pitch/linuxHome ]] && rm -r ~/pitch/linuxHome 
cp -r ~/devel/linuxHome ~/pitch
cd ~/pitch
(( $? != 0 )) && echo "No ~/pitch to throw from!" && exit 1

# Strip out .git directories
rm -rf $(find linuxHome -name '\.git')

WORK_COMPS="Godzilla Frogger"
SUPER_COMPS="Foobar"

# Distribute to remote computers
for comp in $WORK_COMPS $SUPER_COMPS
do
    echo "Pushing to $comp:"
    eval to${comp} linuxHome
done

echo "Pushed to:"
for comp in $WORK_COMPS $SUPER_COMPS
do
    echo "    $comp:"
done
